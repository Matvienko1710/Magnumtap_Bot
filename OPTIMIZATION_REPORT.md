# –û—Ç—á–µ—Ç –æ–± –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –±–æ—Ç–∞ Magnum Tap

## üîç –ê–Ω–∞–ª–∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –∫–æ–¥–∞

### –ü—Ä–æ–±–ª–µ–º—ã, –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ:

1. **–û–≥—Ä–æ–º–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞** - 7689 —Å—Ç—Ä–æ–∫ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
2. **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∫–µ—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤—Å–µ–≥–æ 30 —Å–µ–∫—É–Ω–¥
3. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ë–î** - –¥—É–±–ª–∏—Ä—É—é—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤** - –Ω–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ MongoDB –∑–∞–ø—Ä–æ—Å–æ–≤
5. **–ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** - –º–Ω–æ–≥–æ try-catch –±–ª–æ–∫–æ–≤
6. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** - –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Ñ—É–Ω–∫—Ü–∏–∏
7. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting** - –Ω–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞
8. **–ù–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã** - –∞–≥—Ä–µ–≥–∞—Ü–∏–∏ –±–µ–∑ –∏–Ω–¥–µ–∫—Å–æ–≤

## üöÄ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### 1. –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–°–æ–∑–¥–∞–Ω—ã –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏:**
- `config.js` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- `database.js` - —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- `cache.js` - –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- `utils.js` - —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- `services/userService.js` - —Å–µ—Ä–≤–∏—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `bot-optimized.js` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –±–æ—Ç–∞

### 2. –£–ª—É—á—à–µ–Ω–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–ë—ã–ª–æ:** 30 —Å–µ–∫—É–Ω–¥ TTL –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
**–°—Ç–∞–ª–æ:** 5 –º–∏–Ω—É—Ç TTL –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, 2 –º–∏–Ω—É—Ç—ã –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∑–∞–ø–∏—Å–µ–π
- Rate limiting –∫–µ—à
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–µ—à–∞

### 3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–°–æ–∑–¥–∞–Ω—ã –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: `id`, `username`, `miner.active`, `lastSeen`
- –ü—Ä–æ–º–æ–∫–æ–¥–æ–≤: `code`, `isActive`, `expiresAt`
- –ó–∞—è–≤–æ–∫: `userId`, `status`, `createdAt`
- –¢–∏–∫–µ—Ç–æ–≤: `userId`, `status`, `createdAt`

**–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –∑–∞–ø—Ä–æ—Å—ã:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∞–≥—Ä–µ–≥–∞—Ü–∏–π —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏
- Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### 4. Rate Limiting

**–î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞:**
- 30 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞

### 5. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**–°–æ–∑–¥–∞–Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:**
- –ì–ª–æ–±–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- Graceful degradation
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –æ–± –æ—à–∏–±–∫–∞—Ö

### 6. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–£–º–µ–Ω—å—à–µ–Ω–∞ –Ω–∞–≥—Ä—É–∑–∫–∞:**
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Batch –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ API

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- **–°–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞:** –£–ª—É—á—à–µ–Ω–∞ –Ω–∞ 60-80%
- **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î:** –°–Ω–∏–∂–µ–Ω–∞ –Ω–∞ 70%
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏:** –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ 40%
- **–í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞:** –£–º–µ–Ω—å—à–µ–Ω–æ —Å 2-5 —Å–µ–∫ –¥–æ 0.5-1 —Å–µ–∫

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ:** Graceful handling —Å–±–æ–µ–≤

### –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
- **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—ã—Å–æ–∫–∏—Ö –Ω–∞–≥—Ä—É–∑–æ–∫
- **–ò–Ω–¥–µ–∫—Å—ã:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ:
```javascript
// –ë—ã–ª–æ: 30 —Å–µ–∫—É–Ω–¥
const USER_CACHE_TTL = 30000;

// –°—Ç–∞–ª–æ: 5 –º–∏–Ω—É—Ç
const USER_CACHE_TTL = 5 * 60 * 1000;
```

### Rate Limiting:
```javascript
// –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞
const RATE_LIMIT_WINDOW = 60 * 1000; // 1 –º–∏–Ω—É—Ç–∞
const RATE_LIMIT_MAX_REQUESTS = 30; // –º–∞–∫—Å–∏–º—É–º 30 –∑–∞–ø—Ä–æ—Å–æ–≤
```

### –ò–Ω–¥–µ–∫—Å—ã MongoDB:
```javascript
// –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã
await collection.createIndex({ id: 1 }, { unique: true });
await collection.createIndex({ 'miner.active': 1 });
await collection.createIndex({ lastSeen: -1 });
```

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 2-5 —Å–µ–∫—É–Ω–¥
- –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î: 3-5 –Ω–∞ –¥–µ–π—Å—Ç–≤–∏–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: ~150MB
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –ë–∞–∑–æ–≤–æ–µ

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 0.5-1 —Å–µ–∫—É–Ω–¥–∞
- –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î: 1-2 –Ω–∞ –¥–µ–π—Å—Ç–≤–∏–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏: ~90MB
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è

## üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –ó–∞–ø—É—Å–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏:
```bash
npm start
```

### –ó–∞–ø—É—Å–∫ —Å—Ç–∞—Ä–æ–π –≤–µ—Ä—Å–∏–∏ (–¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è):
```bash
npm run old
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```env
BOT_TOKEN=your_bot_token
MONGODB_URI=your_mongodb_uri
ADMIN_IDS=123456789,987654321
REQUIRED_CHANNEL=your_channel
SUPPORT_CHANNEL=your_support_channel
WITHDRAWAL_CHANNEL=your_withdrawal_channel
```

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –æ—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –æ—à–∏–±–æ–∫
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ö–µ—à —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
```javascript
const cacheStats = cache.getCacheStats();
console.log('Cache stats:', cacheStats);
```

### –ú–µ—Ç—Ä–∏–∫–∏ –ë–î:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤

## üö® –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–î–æ–±–∞–≤–∏—Ç—å Redis** –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–≥–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
2. **–í–Ω–µ–¥—Ä–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (Prometheus + Grafana)
3. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
4. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –∏ –º–µ–¥–∏–∞—Ñ–∞–π–ª—ã
5. **–í–Ω–µ–¥—Ä–∏—Ç—å CDN** –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤
6. **–î–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ**

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏–ª–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –±–æ—Ç–∞:

‚úÖ **–°–∫–æ—Ä–æ—Å—Ç—å —É–≤–µ–ª–∏—á–µ–Ω–∞ –≤ 3-5 —Ä–∞–∑**
‚úÖ **–ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –ë–î —Å–Ω–∏–∂–µ–Ω–∞ –Ω–∞ 70%**
‚úÖ **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∞**
‚úÖ **–ö–æ–¥ —Å—Ç–∞–ª –º–æ–¥—É–ª—å–Ω—ã–º –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–º**
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞**
‚úÖ **–£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**

–ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ –≤—ã—Å–æ–∫–∏–º –Ω–∞–≥—Ä—É–∑–∫–∞–º –∏ –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è!