# Telegram Stars Bot

Бот для фарма звёзд с инлайн-кнопкой, бонусами, рефералами, промокодами и админ-панелью. Данные хранятся в MongoDB Atlas.

## Возможности
- Фарм звёзд раз в минуту
- Бонус раз в 24 часа
- Реферальная система
- Промокоды с лимитом активаций
- Админ-панель (рассылка, промокоды, статистика)
- Обязательная подписка на канал

## Структура коллекций MongoDB

- **users** — пользователи бота
  - `id` — Telegram ID
  - `stars` — количество звёзд
  - `lastFarm` — время последнего фарма
  - `lastBonus` — время последнего бонуса
  - `invited` — сколько друзей приглашено
  - `invitedBy` — кто пригласил
- **tasks** — задания (можно расширять под свои нужды)
- **promocodes** — промокоды
  - `code` — строка промокода (UPPERCASE)
  - `stars` — сколько звёзд даёт
  - `max` — лимит активаций
  - `used` — сколько раз активирован

Коллекции создаются автоматически при первом использовании.

## Быстрый старт локально

1. Склонируйте репозиторий и перейдите в папку:
   ```bash
   git clone <ваш-репозиторий>
   cd <ваш-репозиторий>
   ```
2. Установите зависимости:
   ```bash
   npm install
   ```
3. Создайте файл `.env` по примеру `.env.example` и укажите:
   ```env
   BOT_TOKEN=ваш_токен_бота
   MONGODB_URI=ваша_строка_подключения
   ADMIN_IDS=123456789,987654321
   REQUIRED_CHANNEL=@ваш_канал
   ```
4. Запустите бота:
   ```bash
   npm start
   ```

## Деплой на Railway

1. Зарегистрируйтесь на [Railway](https://railway.app/).
2. Нажмите "New Project" → "Deploy from GitHub repo" и выберите этот репозиторий.
3. Railway сам определит Node.js проект. Перейдите во вкладку **Variables** и добавьте переменные окружения:
   - `BOT_TOKEN` — токен вашего Telegram-бота
   - `MONGODB_URI` — строка подключения к вашей MongoDB Atlas
   - `ADMIN_IDS` — Telegram ID админов через запятую
   - `REQUIRED_CHANNEL` — username или id канала (например, `@magnumtap` или `-1001234567890`)
4. Нажмите "Deploy".
5. После деплоя Railway автоматически запустит бота.

## Получение токена Telegram-бота
1. Откройте Telegram и найдите @BotFather
2. Создайте нового бота командой `/newbot` и получите токен

## Получение строки подключения MongoDB
1. Зарегистрируйтесь на [MongoDB Atlas](https://www.mongodb.com/cloud/atlas)
2. Создайте бесплатный кластер
3. Создайте пользователя и получите строку подключения (URI)

## Переменные окружения
- `BOT_TOKEN` — токен Telegram-бота
- `MONGODB_URI` — строка подключения к MongoDB
- `ADMIN_IDS` — Telegram ID админов через запятую
- `REQUIRED_CHANNEL` — username/id канала для обязательной подписки

## Лицензия
MIT