# Настройка UptimeRobot для Magnum Stars Bot

## Что такое UptimeRobot?

UptimeRobot - это бесплатный сервис мониторинга, который может периодически обращаться к вашему боту и держать его активным на Render.com, предотвращая "засыпание" приложения.

## Зачем это нужно?

Render.com переводит бесплатные приложения в "спящий режим" после 15 минут неактивности. UptimeRobot будет "будить" вашего бота каждые несколько минут, поддерживая его в активном состоянии.

## Настройка UptimeRobot

### 1. Регистрация на UptimeRobot

1. Перейдите на [uptimerobot.com](https://uptimerobot.com)
2. Зарегистрируйтесь (бесплатный план включает 50 мониторов)
3. Войдите в свой аккаунт

### 2. Создание монитора

1. Нажмите "Add New Monitor"
2. Выберите тип монитора: **HTTP(s)**
3. Заполните поля:
   - **Friendly Name**: `Magnum Stars Bot Health Check`
   - **URL**: `https://your-app-name.onrender.com/health`
   - **Monitoring Interval**: `5 minutes` (рекомендуется)
   - **Timeout**: `30 seconds`
   - **Alert When Down**: `1`
   - **Alert When Up**: `1`

### 3. Альтернативные URL для мониторинга

Вы можете использовать любой из этих эндпоинтов:

- **Основной health check**: `https://your-app-name.onrender.com/health`
- **Простая проверка**: `https://your-app-name.onrender.com/ping`
- **Детальная проверка**: `https://your-app-name.onrender.com/api/status`
- **Корневой эндпоинт**: `https://your-app-name.onrender.com/`

### 4. Настройка уведомлений (опционально)

1. В настройках монитора включите уведомления
2. Добавьте email или Telegram для получения уведомлений о статусе бота

## Проверка работы

### Тестирование эндпоинтов

После деплоя бота на Render.com, проверьте работу эндпоинтов:

```bash
# Проверка основного health check
curl https://your-app-name.onrender.com/health

# Проверка простого ping
curl https://your-app-name.onrender.com/ping

# Проверка детального статуса
curl https://your-app-name.onrender.com/api/status
```

### Ожидаемые ответы

**Health Check (`/health`):**
```json
{
  "status": "healthy",
  "message": "Magnum Stars Bot is alive and running",
  "timestamp": "2025-01-27T10:30:00.000Z",
  "uptime": 3600,
  "memory": {
    "rss": 123456789,
    "heapTotal": 987654321,
    "heapUsed": 123456789,
    "external": 12345
  },
  "version": "1.0.0",
  "environment": "production"
}
```

**Ping (`/ping`):**
```
pong
```

**Status (`/api/status`):**
```json
{
  "status": "ok",
  "bot": {
    "status": "running",
    "username": "your_bot_username"
  },
  "database": {
    "status": "connected",
    "name": "your_database_name"
  },
  "server": {
    "uptime": 3600,
    "memory": {...},
    "timestamp": "2025-01-27T10:30:00.000Z"
  },
  "environment": "production"
}
```

## Рекомендации

### 1. Интервал мониторинга
- **Рекомендуется**: 5 минут
- **Минимально**: 10 минут
- **Максимально**: 15 минут (чтобы не превысить лимит "сна" на Render.com)

### 2. Таймаут
- Установите таймаут 30-60 секунд
- Это даст достаточно времени для "пробуждения" приложения

### 3. Мониторинг нескольких эндпоинтов
Можно создать несколько мониторов для разных эндпоинтов:
- Основной: `/health` (каждые 5 минут)
- Резервный: `/ping` (каждые 10 минут)

### 4. Уведомления
Настройте уведомления для:
- Когда бот недоступен более 5 минут
- Когда бот снова становится доступным

## Альтернативные сервисы

Если UptimeRobot не подходит, можно использовать:

1. **Cron-job.org** - бесплатный cron сервис
2. **EasyCron** - еще один бесплатный cron сервис
3. **GitHub Actions** - если у вас есть репозиторий на GitHub
4. **Heroku Scheduler** - если используете Heroku

## Пример настройки через curl

Если хотите настроить мониторинг через cron job:

```bash
# Добавьте в crontab (каждые 5 минут)
*/5 * * * * curl -s https://your-app-name.onrender.com/health > /dev/null 2>&1
```

## Устранение неполадок

### Бот не отвечает
1. Проверьте, что приложение развернуто на Render.com
2. Убедитесь, что URL правильный
3. Проверьте логи в Render.com Dashboard

### Частые ошибки
1. Увеличьте интервал мониторинга до 10 минут
2. Увеличьте таймаут до 60 секунд
3. Проверьте, не превышает ли приложение лимиты Render.com

### Ложные срабатывания
1. Увеличьте количество попыток перед уведомлением
2. Проверьте стабильность интернет-соединения
3. Рассмотрите использование нескольких мониторов

## Заключение

После настройки UptimeRobot ваш бот будет оставаться активным 24/7, что обеспечит стабильную работу для всех пользователей. Мониторинг будет автоматически "будить" приложение каждые несколько минут, предотвращая переход в спящий режим.
